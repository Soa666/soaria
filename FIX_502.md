# 502 Bad Gateway / Connection Refused beheben

## Problem
- 502 Bad Gateway: Nginx kann die Services nicht erreichen
- Connection Refused: Services laufen nur auf localhost, nicht auf 0.0.0.0

## Lösung

### 1. Frontend Vite Config anpassen

Die `vite.config.js` muss `host: '0.0.0.0'` haben. Siehe Änderung oben.

### 2. Frontend neu builden (falls nötig)

```bash
cd ~/Soaria/frontend
npm run build
```

### 3. PM2 mit --update-env neu starten

```bash
cd ~/Soaria

# Beide Services stoppen
pm2 stop all

# Mit --update-env neu starten (lädt .env neu)
pm2 restart all --update-env

# Oder einzeln:
pm2 restart soaria-backend --update-env
pm2 restart soaria-frontend --update-env
```

### 4. Prüfen ob Services laufen

```bash
# Status prüfen
pm2 status

# Logs prüfen
pm2 logs soaria-backend
pm2 logs soaria-frontend

# Prüfen auf welchen Ports gebunden wird
netstat -tlnp | grep -E "3000|3001"
# oder
ss -tlnp | grep -E "3000|3001"
```

### 5. Vite Preview Host-Einstellung testen

Falls Vite Preview immer noch nicht auf 0.0.0.0 läuft, kannst du es manuell starten:

```bash
cd ~/Soaria/frontend
npm run preview -- --host 0.0.0.0
```

Aber besser: Die vite.config.js anpassen (siehe oben).
